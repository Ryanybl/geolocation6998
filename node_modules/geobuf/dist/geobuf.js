!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).geobuf=e()}}(function(){return function o(a,u,f){function l(t,e){if(!u[t]){if(!a[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=u[t]={exports:{}};a[t][0].call(i.exports,function(e){var r=a[t][1][e];return l(r||e)},i,i.exports,o,a,u,f)}return u[t].exports}for(var s="function"==typeof require&&require,e=0;e<f.length;e++)l(f[e]);return l}({1:[function(e,r,t){"use strict";var o,a,u,l,s;r.exports=function(e){l=2,s=Math.pow(10,6),u=null,o=[],a=[];var r=e.readFields(n,{});return o=null,r};var f=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"];function n(e,r,t){var n,i;1===e?o.push(t.readString()):2===e?l=t.readVarint():3===e?s=Math.pow(10,t.readVarint()):4===e?(n=t,(i=r).type="FeatureCollection",i.features=[],n.readMessage(c,i)):5===e?d(t,r):6===e&&p(t,r)}function d(e,r){r.type="Feature";var t=e.readMessage(i,r);return t.hasOwnProperty("geometry")||(t.geometry=null),t}function p(e,r){return e.readMessage(g,r)}function c(e,r,t){1===e?r.features.push(d(t,{})):13===e?a.push(y(t)):15===e&&h(t,r)}function i(e,r,t){1===e?r.geometry=p(t,{}):11===e?r.id=t.readString():12===e?r.id=t.readSVarint():13===e?a.push(y(t)):14===e?r.properties=h(t,{}):15===e&&h(t,r)}function g(e,r,t){var n,i,o;1===e?r.type=f[t.readVarint()]:2===e?u=t.readPackedVarint():3===e?(i=t,"Point"===(o=(n=r).type)?n.coordinates=function(e){for(var r=e.readVarint()+e.pos,t=[];e.pos<r;)t.push(e.readSVarint()/s);return t}(i):"MultiPoint"===o?n.coordinates=w(i):"LineString"===o?n.coordinates=w(i):"MultiLineString"===o?n.coordinates=M(i):"Polygon"===o?n.coordinates=M(i,!0):"MultiPolygon"===o&&(n.coordinates=function(e){var r=e.readVarint()+e.pos;if(!u)return[[v(e,r,null,!0)]];for(var t=[],n=1,i=0;i<u[0];i++){for(var o=[],a=0;a<u[n];a++)o.push(v(e,r,u[n+1+a],!0));n+=u[n]+1,t.push(o)}return u=null,t}(i))):4===e?(r.geometries=r.geometries||[],r.geometries.push(p(t,{}))):13===e?a.push(y(t)):15===e&&h(t,r)}function y(e){for(var r=e.readVarint()+e.pos,t=null;e.pos<r;){var n=e.readVarint()>>3;1===n?t=e.readString():2===n?t=e.readDouble():3===n?t=e.readVarint():4===n?t=-e.readVarint():5===n?t=e.readBoolean():6===n&&(t=JSON.parse(e.readString()))}return t}function h(e,r){for(var t=e.readVarint()+e.pos;e.pos<t;)r[o[e.readVarint()]]=a[e.readVarint()];return a=[],r}function v(e,r,t,n){var i,o,a=0,u=[],f=[];for(o=0;o<l;o++)f[o]=0;for(;t?a<t:e.pos<r;){for(i=[],o=0;o<l;o++)f[o]+=e.readSVarint(),i[o]=f[o]/s;u.push(i),a++}return n&&u.push(u[0]),u}function w(e){return v(e,e.readVarint()+e.pos)}function M(e,r){var t=e.readVarint()+e.pos;if(!u)return[v(e,t,null,r)];for(var n=[],i=0;i<u.length;i++)n.push(v(e,t,u[i],r));return u=null,n}},{}],2:[function(e,r,t){"use strict";r.exports=function(e,r){a={},o=[],f=i=0,l=1,function e(r){var t,n;if("FeatureCollection"===r.type)for(t=0;t<r.features.length;t++)e(r.features[t]);else if("Feature"===r.type)for(n in null!==r.geometry&&e(r.geometry),r.properties)g(n);else if("Point"===r.type)c(r.coordinates);else if("MultiPoint"===r.type)p(r.coordinates);else if("GeometryCollection"===r.type)for(t=0;t<r.geometries.length;t++)e(r.geometries[t]);else if("LineString"===r.type)p(r.coordinates);else if("Polygon"===r.type||"MultiLineString"===r.type)d(r.coordinates);else if("MultiPolygon"===r.type)for(t=0;t<r.coordinates.length;t++)d(r.coordinates[t]);for(n in r)S(n,r.type)||g(n)}(e),l=Math.min(l,u);for(var t=Math.ceil(Math.log(l)/Math.LN10),n=0;n<o.length;n++)r.writeStringField(1,o[n]);2!==f&&r.writeVarintField(2,f);6!==t&&r.writeVarintField(3,t);"FeatureCollection"===e.type?r.writeMessage(4,y,e):"Feature"===e.type?r.writeMessage(5,h,e):r.writeMessage(6,v,e);return a=null,r.finish()};var a,i,o,f,l,u=1e6,s={Point:0,MultiPoint:1,LineString:2,MultiLineString:3,Polygon:4,MultiPolygon:5,GeometryCollection:6};function d(e){for(var r=0;r<e.length;r++)p(e[r])}function p(e){for(var r=0;r<e.length;r++)c(e[r])}function c(e){f=Math.max(f,e.length);for(var r=0;r<e.length;r++)for(;Math.round(e[r]*l)/l!==e[r]&&l<u;)l*=10}function g(e){void 0===a[e]&&(o.push(e),a[e]=i++)}function y(e,r){for(var t=0;t<e.features.length;t++)r.writeMessage(1,h,e.features[t]);w(e,r,!0)}function h(e,r){null!==e.geometry&&r.writeMessage(1,v,e.geometry),void 0!==e.id&&("number"==typeof e.id&&e.id%1==0?r.writeSVarintField(12,e.id):r.writeStringField(11,e.id)),e.properties&&w(e.properties,r),w(e,r,!0)}function v(e,r){r.writeVarintField(1,s[e.type]);var t=e.coordinates;if("Point"===e.type)!function(e,r){for(var t=[],n=0;n<f;n++)t.push(Math.round(e[n]*l));r.writePackedSVarint(3,t)}(t,r);else if("MultiPoint"===e.type)V(t,r);else if("LineString"===e.type)V(t,r);else if("MultiLineString"===e.type)m(t,r);else if("Polygon"===e.type)m(t,r,!0);else if("MultiPolygon"===e.type)!function(e,r){var t,n,i=e.length;if(1!==i||1!==e[0].length){var o=[i];for(t=0;t<i;t++)for(o.push(e[t].length),n=0;n<e[t].length;n++)o.push(e[t][n].length-1);r.writePackedVarint(2,o)}var a=[];for(t=0;t<i;t++)for(n=0;n<e[t].length;n++)P(a,e[t][n],!0);r.writePackedSVarint(3,a)}(t,r);else if("GeometryCollection"===e.type)for(var n=0;n<e.geometries.length;n++)r.writeMessage(4,v,e.geometries[n]);w(e,r,!0)}function w(e,r,t){var n=[],i=0;for(var o in e)t&&S(o,e.type)||(r.writeMessage(13,M,e[o]),n.push(a[o]),n.push(i++));r.writePackedVarint(t?15:14,n)}function M(e,r){if(null!==e){var t=typeof e;"string"===t?r.writeStringField(1,e):"boolean"===t?r.writeBooleanField(5,e):"object"===t?r.writeStringField(6,JSON.stringify(e)):"number"===t&&(e%1!=0?r.writeDoubleField(2,e):0<=e?r.writeVarintField(3,e):r.writeVarintField(4,-e))}}function V(e,r){var t=[];P(t,e),r.writePackedSVarint(3,t)}function m(e,r,t){var n,i=e.length;if(1!==i){var o=[];for(n=0;n<i;n++)o.push(e[n].length-(t?1:0));r.writePackedVarint(2,o)}var a=[];for(n=0;n<i;n++)P(a,e[n],t);r.writePackedSVarint(3,a)}function P(e,r,t){var n,i,o=r.length-(t?1:0),a=new Array(f);for(i=0;i<f;i++)a[i]=0;for(n=0;n<o;n++)for(i=0;i<f;i++){var u=Math.round(r[n][i]*l)-a[i];e.push(u),a[i]+=u}}function S(e,r){if("type"===e)return!0;if("FeatureCollection"===r){if("features"===e)return!0}else if("Feature"===r){if("id"===e||"properties"===e||"geometry"===e)return!0}else if("GeometryCollection"===r){if("geometries"===e)return!0}else if("coordinates"===e)return!0;return!1}},{}],3:[function(e,r,t){"use strict";t.encode=e("./encode"),t.decode=e("./decode")},{"./decode":1,"./encode":2}]},{},[3])(3)});
